TAG: 浏览器
DECK: 前端

## 浏览器事件机制

### 事件
在HTML文档或浏览器中，事件指的是用户与页面进行交互时触发的动作，例如点击、输入、滚动等。每个事件都有一个目标元素，并且可能会沿着DOM树进行传播。

### 事件流
事件流指的是事件在DOM结构中的传播过程，主要分为三个阶段：
1. **事件捕获阶段**：事件从最外层祖先元素向目标元素传递。
2. **目标阶段**：事件到达目标元素并触发。
3. **事件冒泡阶段**：事件从目标元素沿DOM树向上，逐步传递到最外层祖先元素。


### 事件模型
浏览器有三种主要的事件模型：
1. **原始事件模型**：
   - 仅支持事件冒泡。
   - 事件处理速度快，但同类型事件只能绑定一个处理函数，后绑定的会覆盖先前的。
   - 事件绑定方式：HTML属性绑定或JS代码设置。
2. **标准事件模型**：
   - 包含捕获、目标处理、冒泡三个阶段。
   - 可通过`addEventListener`绑定多个处理函数，并指定是否在捕获阶段触发。
3. **IE事件模型**：
   - 仅支持事件冒泡。
   - 使用`attachEvent`绑定，不会覆盖，可绑定多个处理函数。


### 事件方法
- `preventDefault()` 阻止默认行为，`stopPropagation()` 阻止事件进一步传播。
- 两者可以结合使用，先阻止默认行为，再阻止事件传播。

---

1. **原始事件模型**
   - 这种模型只能处理**事件冒泡**，即事件只能在目标元素到祖先元素的过程中传播。
   - 速度快，但同类型事件只能绑定一次，后绑定的事件处理函数会覆盖之前的处理函数。
   - 事件绑定方式：可以通过HTML中的属性直接绑定事件处理函数，也可以通过JS代码给元素设置事件处理函数。
     - HTML绑定：
       ```html
   <input type="button" onclick="fun()">
       ```
     - JS代码绑定：
       ```js
   btn.onclick = fun;
       ```

2. **标准事件模型**
   - 支持**捕获、目标处理、冒泡**三个阶段。
   - 可以通过`addEventListener`绑定事件处理函数，并指定是否在捕获阶段触发。
     - 使用方法：
       ```js
   element.addEventListener(eventType, handler, useCapture);
       ```
       - `eventType`：事件类型，例如`click`、`input`等。
       - `handler`：事件处理函数。
       - `useCapture`：是否在捕获阶段触发，`true`为捕获，`false`为冒泡（默认值）。

3. **IE事件模型**
   - IE事件模型只支持**事件冒泡**，与原始事件模型类似。
   - 事件绑定使用`attachEvent`，不会覆盖之前绑定的处理函数。
   - 使用方法：
     ```js
     element.attachEvent('on' + eventType, handler);
     ```

### 事件代理

**事件代理**是指将一个元素的事件委托给另一个元素（通常是父元素），利用事件冒泡来处理子元素的事件。这样可以减少绑定的事件数量，提高性能，尤其是在需要对大量子元素处理事件时。[[React事件机制]]就是基于事件代理的。
  
场景：
1. **大量子元素**：减少对子元素逐一绑定事件的开销，将事件委托给父元素统一处理。
2. **动态绑定解绑**：当子元素动态添加或移除时，不需要手动绑定或解绑事件，父元素可以自动捕获新添加的子元素的事件。
 
示例：
```html
<ul id="parent">
  <li>Item 1</li>
  <li>Item 2</li>
</ul>
```
```js
document.getElementById('parent').addEventListener('click', function(event) {
  if (event.target.tagName === 'LI') {
    console.log('Clicked:', event.target.textContent);
  }
});
```
在这个例子中，父元素`ul`统一监听`li`的点击事件，而不需要为每个`li`单独绑定。


`event.preventDefault()` 和 `event.stopPropagation()` 是JavaScript中处理事件时常用的两个方法，它们的作用不同：
### event.preventDefault()
- **用途**：这个方法用于阻止浏览器对某个事件的默认行为。例如，在点击提交按钮时，浏览器默认会提交表单，使用`preventDefault()`可以阻止这个行为。
- **效果**：调用这个方法后，尽管事件仍会继续传递，但浏览器不会执行与该事件关联的默认动作。例如，点击链接不会导航到新的URL，或者点击表单提交按钮不会提交表单。
- **示例**：
  ```javascript
  document.getElementById("myButton").addEventListener("click", function(event){
    event.preventDefault();
    // 其他代码，比如自定义表单处理
  });
  ```
### event.stopPropagation()
- **用途**：这个方法用于阻止事件在DOM中继续向上冒泡。在事件冒泡阶段，事件会从触发它的元素开始，逐级向上传播到文档的根元素。
- **效果**：调用这个方法后，当前事件不会继续向上冒泡，但同一元素上的其他事件处理器仍然会被触发。它不会阻止默认行为的发生。
- **示例**：
  ```javascript
  document.getElementById("myDiv").addEventListener("click", function(event){
    event.stopPropagation();
    // 其他代码，比如仅在该元素上处理事件
  });
  ```
### 区别总结：

在实际应用中，根据具体情况选择使用这两个方法，有时甚至需要同时使用它们来达到期望的效果。



END
<!--ID: 1726212442518-->

