TAG: JS
DECK: 前端

## 深浅拷贝、比较

浅层比较、深层比较和深浅拷贝都是在处理数据结构和对象时的重要概念。它们的关系和区别可以通过以下几个方面来理解：
- **浅层比较**：比较对象或数组的引用或第一层属性的值。用于快速检查对象的变化。
- **深层比较**：递归比较所有层级的属性值。用于精确检查对象的完整内容。
- **浅拷贝**：创建新对象，只复制第一层属性。嵌套属性仍然引用原始对象。
- **深拷贝**：创建新对象，并递归地复制所有层级的属性。新对象与原始对象完全独立。

### 1. **浅层比较（Shallow Comparison）**
**定义**：浅层比较是比较对象或数组的第一层属性的值，而不深入到嵌套的属性或元素。

**行为**：
- 对于基本数据类型（如 `number`、`string`、`boolean`），直接比较值是否相等。
- 对于对象和数组，比较的是它们的引用是否相同，而不是它们的内容。

**示例**：
```javascript
const obj1 = { a: 1, b: { c: 2 } };
const obj2 = { a: 1, b: { c: 2 } };

console.log(obj1 === obj2); // false，因为对象引用不同

const arr1 = [1, 2, 3];
const arr2 = [1, 2, 3];

console.log(arr1 === arr2); // false，因为数组引用不同
```

### 2. **深层比较（Deep Comparison）**

**定义**：深层比较是递归地比较对象或数组的所有嵌套属性，检查它们的内容是否相同。

**行为**：
- 比较对象的所有嵌套属性或数组的所有元素，直到最深层。
- 需要递归地检查每一层的属性值。

**示例**：
```javascript
const obj1 = { a: 1, b: { c: 2 } };
const obj2 = { a: 1, b: { c: 2 } };

const deepEqual = (x, y) => {
  if (x === y) return true;
  if (typeof x !== 'object' || typeof y !== 'object' || x === null || y === null) return false;

  let keysX = Object.keys(x);
  let keysY = Object.keys(y);

  if (keysX.length !== keysY.length) return false;

  for (let key of keysX) {
    if (!keysY.includes(key) || !deepEqual(x[key], y[key])) return false;
  }

  return true;
};

console.log(deepEqual(obj1, obj2)); // true，因为对象的内容完全相同
```

### 3. **浅拷贝（Shallow Copy）**

**定义**：浅拷贝是创建一个新对象，但只复制对象的第一层属性，嵌套的属性依然引用原始对象的值。

**行为**：
- 对于对象的第一层属性创建一个新对象，但嵌套的对象或数组仍然是引用类型，指向原始对象的嵌套属性。

**示例**：
```javascript
const obj1 = { a: 1, b: { c: 2 } };
const obj2 = { ...obj1 }; // 浅拷贝

console.log(obj1 === obj2); // false，因为 obj1 和 obj2 是不同的对象
console.log(obj1.b === obj2.b); // true，因为 b 的引用没有改变
```

### 4. **深拷贝（Deep Copy）**

**定义**：深拷贝是创建一个新对象，并且递归地复制所有嵌套的对象或数组，确保新对象与原始对象完全独立。

**行为**：
- 创建一个新对象，新对象的每一层属性都与原始对象的每一层属性相同，但不共享引用。

**示例**：
```javascript
const obj1 = { a: 1, b: { c: 2 } };

// 使用 JSON 方法进行深拷贝
const obj2 = JSON.parse(JSON.stringify(obj1));

console.log(obj1 === obj2); // false，因为 obj1 和 obj2 是不同的对象
console.log(obj1.b === obj2.b); // false，因为 b 的引用也被复制了
```

END
<!--ID: 1726713820517-->
