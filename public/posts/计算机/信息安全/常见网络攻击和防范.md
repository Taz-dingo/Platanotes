---
created: 星期四, 八月 22日 2024, 10:28:44 晚上, 1724336924000
modified: 星期四, 八月 22日 2024, 10:28:44 晚上, 1724336924000
---

TAG: 网络
DECK: 前端

## 常见网络攻击和防范

- **XSS防范** 主要通过**输入验证**、**输出编码**、**内容安全策略**（CSP）来防止恶意脚本注入。
- **CSRF防范** 依赖于**CSRF Token**、**SameSite Cookie**、**验证请求来源**等方式确保请求是由合法用户发起的。

同源策略是浏览器的一种安全机制，它限制了来自不同源的脚本如何互相访问。它的定义如下：

- **源（Origin）** 是指协议、域名和端口号的组合。例如，`https://example.com:443`。

[[同源策略]]主要防护以下内容：
限制了从一个源加载的文档或脚本如何与另一个源的资源进行交互（包括读、写）。

---

### XSS

cross-site-script，跨站脚本攻击，其实应该是CSS，但是和样式的CSS撞了改名XSS。
防范的方法就是服务器对请求加校验、渲染页面也加校验。

### 反射型

- XSS 脚本来自当前 HTTP 请求
- 当服务器在 HTTP 请求中接收数据并将该数据拼接在 HTML 中返回时，例子：

这种多出现在一些不安全的写法里面（比如输入内容**不加校验**地**直接渲染到HTML里**）。现代框架渲染时一般都带有转义，避免了XSS攻击。

```js
// 某网站具有搜索功能，该功能通过 URL 参数接收用户提供的搜索词：
https://xxx.com/search?query=123
// 服务器在对此 URL 的响应中回显提供的搜索词：
<p>您搜索的是: 123</p>
// 如果服务器不对数据进行转义等处理，则攻击者可以构造如下链接进行攻击：
https://xxx.com/search?query=<img src="empty.png" onerror ="alert('xss')">
// 该 URL 将导致以下响应，并运行 alert('xss')：
<p>您搜索的是: <img src="empty.png" onerror ="alert('xss')"></p>
// 如果有用户请求攻击者的 URL ，则攻击者提供的脚本将在用户的浏览器中执行。
```


### 存储型

- XSS 脚本来自服务器数据库中
- 攻击者将恶意代码提交到目标网站的数据库中，普通用户访问网站时服务器将恶意代码返回，浏览器默认执行，例子：

```js
// 某个评论页，能查看用户评论。
// 攻击者将恶意代码当做评论提交，服务器没对数据进行转义等处理
// 评论输入：
<textarea>
  <img src="empty.png" onerror ="alert('xss')">
</textarea>
// 则攻击者提供的脚本将在所有访问该评论页的用户浏览器执行
```


### XSS（跨站脚本攻击）的防范方法

1. **输入验证和输出转义：**
    - 输入验证：对所有输入数据进行验证，确保它们符合预期的格式和数据类型。这可以帮助阻止或过滤掉潜在的危险字符和代码。
    - 输出转义：在将动态数据插入到应用程序界面之前，对数据进行HTML实体编码。这样可以在显示数据时将其视为纯文本，而不是可执行的代码。
2. **HTTP响应头 / meta标签设置内容安全策略（CSP）：**
    - CSP是一种现代的Web安全标准，它可以指示浏览器仅从指定的源执行活动内容（如JavaScript）。通过配置CSP，可以极大地降低XSS攻击的风险。
3. **cookie设置HttpOnly和Secure：**
    - 设置HttpOnly和Secure标志可以增强Cookie的安全性。HttpOnly标志可以**防止客户端脚本读取Cookie**，从而减少了通过XSS攻击窃取敏感信息的机会。
    - Secure标志确保Cookie仅在HTTPS连接上传输，这有助于保护Cookie免受中间人攻击的影响。

CSP（Content Security Policy）是一种用于防止跨站脚本攻击（XSS）和其他代码注入攻击的安全机制。**通过配置 CSP，开发者可以明确告诉浏览器允许加载哪些资源（如脚本、样式、图像等）**，限制不可信的内容执行，从而有效降低代码注入带来的安全风险。

**CSP 的主要功能：**

- **防止 XSS 攻击**：通过严格控制哪些脚本、样式或内容可以被加载，防止恶意的第三方代码注入页面并执行。
- **防止数据注入攻击**：例如防止攻击者通过广告、第三方插件等渠道注入恶意脚本。
- **报告违规行为**：CSP 可以配置报告机制，允许浏览器将违反策略的行为发送到指定的服务器，用于监控和调试。

---

### CSRF（跨站请求伪造）

2008 - [Gmail攻击](https://www.davidairey.com/google-gmail-security-hijack/)

**CSRF** 攻击是指攻击者诱使已认证用户向受信任网站发送伪造请求，从而利用用户的身份进行未授权的操作。CSRF 攻击通常依赖于用户的认证信息（如 cookies）被不受信任的第三方请求所利用。

**防护措施：**

- **CSRF Token**：在每个需要防护的请求中包含一个 CSRF Token，服务器验证该 Token 是否写·有效。
- **SameSite Cookies**：通过设置 cookies 的 `SameSite` 属性为 `Strict` 或 `Lax`，可以限制 cookies 只在同源请求中发送，从而减少 CSRF 攻击的可能性。
- **检查 Referer 头**：检查请求的 Referer 头部，确保请求来源于可信的页面（虽然这种方法不如 CSRF Token 安全）。


[^1]: [浅谈 React 中的 XSS 攻击](https://juejin.cn/post/6874743455776505870#heading-6)

END
<!--ID: 1726849380174-->

