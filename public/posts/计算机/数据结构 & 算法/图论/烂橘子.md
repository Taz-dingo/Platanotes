
[994. 腐烂的橘子](https://leetcode.cn/problems/rotting-oranges/)

```typescript
// bfs
// 初始找到当前所有烂橘子，
// 每轮把队列里的烂橘子四周新鲜橘子变烂，且加入下一轮队列
function orangesRotting(grid: number[][]): number {
    const que = [];
    const rows = grid.length;
    const cols = grid[0].length;
    let cnt = 0;
    let freshOranges = 0;
    const directions = [
        [-1,0],
        [0,1],
        [1,0],
        [0,-1]
    ];
    // init
    let isClear = true;
    for(let r = 0;r < rows;r++){
        for(let c = 0;c < cols;c++){
            if(grid[r][c] === 2){
                que.push([r,c]);
            }else if(grid[r][c] === 1){
                freshOranges++;
            }
        }
    }
    if(freshOranges === 0) return 0;

    while(que.length){
        let size = que.length;
        let infected = false; // 标志位，表示本轮是否有橘子被感染

        while(size--){
            const [curR,curC] = que.shift();
            for(let [dr,dc] of directions){
                const newR = curR+dr;
                const newC = curC+dc;
                if(newR >= 0 && newR < rows && newC >= 0 && newC < cols && grid[newR][newC] === 1){
                    grid[newR][newC] = 2;
                    que.push([newR,newC]);
                    freshOranges--;
                    infected = true;
                }
            }
        }

        if(infected) cnt++;
    }

    return freshOranges ? -1 : cnt;
};
```